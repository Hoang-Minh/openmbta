<% content_for :header do %>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
  <script type="text/javascript">

    var current_stop_id = <%= @stop.id.to_json %>;
    var center_lat = <%= @stop.lat.to_json %>;
    var center_lng = <%= @stop.lng.to_json %>;
    var stops = <%= @stops.to_json %>;
    var imminent_stops = <%= @result[:imminent_stop_ids].to_json %>;
    var zoomLevel = <%= [ :commuter_rail, :boat ].include?(@transport_type) ? 10 : 13 %>;

  </script>
  <%= javascript_include_tag "tripmap"  %>
<% end %>
<% content_for :body_attr, 'onload="initialize()"' %>


<div class="nav">
  <%= link_to "main", "/mobile" %> &gt; <%= link_to "routes", url_for(:controller => "routes", :transport_type => params[:transport_type]) %>
  &gt;
  <%= link_to "trips", url_for(params.merge(:controller => "trips")) %>
  &gt;
  stop
</div>

<div class="note">
Bookmark this page if this is one of your regular stops.
</div>

<div class="info">
  <%= @stop.name %><br/>
  <span style="font-weight:bold"><%= @headsign %></span><br/>
  <%= route_s @route, @transport_type.to_s %>
</div>

<div class="info" style="background-color:white">
  <%= pluralize @arrivals.size, "arrival" %> left
</div>

<div>
  <% @arrivals.each do |arrival| %>
    <div class="arrival-time-float">
        <%= arrival[:arrival_time] %>
    </div>
  <% end %>
</div>
<br style="clear:left"/>

<div id="map_canvas" style="margin-top:10px;width:316px; height:300px"></div>


